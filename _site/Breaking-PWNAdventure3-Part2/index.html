<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.15.1 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Breaking Pwn Adventure 3 - Part 2(Speed Hack, SuperJump and Pointers Offline Mode) - Rahul R</title>
<meta name="description" content="Creating Speed Hack and Super Jump on Pwn Adventure 3 using Cheat Engine">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Rahul R">
<meta property="og:title" content="Breaking Pwn Adventure 3 - Part 2(Speed Hack, SuperJump and Pointers Offline Mode)">
<meta property="og:url" content="http://localhost:4000/Breaking-PWNAdventure3-Part2/">


  <meta property="og:description" content="Creating Speed Hack and Super Jump on Pwn Adventure 3 using Cheat Engine">



  <meta property="og:image" content="http://localhost:4000/assets/images/pwnadventure/logo.png">





  <meta property="article:published_time" content="2022-04-15T00:00:00+05:30">





  

  


<link rel="canonical" href="http://localhost:4000/Breaking-PWNAdventure3-Part2/">







  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "Rahul R",
      "url": "http://localhost:4000",
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Rahul R Feed">
<link rel="shortcut icon" type="image/png" href="/assets/images/hacker.png"/>
<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6FTHS5L22F"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-6FTHS5L22F');
</script>
<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/masthead.png" alt=""></a>
                
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/" >Home</a>
            </li><li class="masthead__menu-item">
              <a href="/year-archive/" >Posts</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/" >Categories</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/" >Tags</a>
            </li><li class="masthead__menu-item">
              <a href="/about/" >About</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>
    

    <div class="initial-content">
      


  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="http://localhost:4000/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        <li class="current">Breaking Pwn Adventure 3 - Part 2(Speed Hack, SuperJump and Pointers Offline Mode)</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="/assets/images/avatar.png" alt="Rahul R" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Rahul R</h3>
    
    
      <p class="author__bio" itemprop="description">
        Pentester, CTF player<br>SOC guy
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">India</span>
        </li>
      

      

      

      

      

      
        <li>
          <a href="https://twitter.com/Rahul_R95" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter
          </a>
        </li>
      

      
        <li>
          <a href="https://www.facebook.com/rahul.raveendran.92351" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-facebook-square" aria-hidden="true"></i> Facebook
          </a>
        </li>
      

      

      
        <li>
          <a href="https://www.linkedin.com/in/rahul-r-3b0433a6" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn
          </a>
        </li>
      

      

      

      

      

      
        <li>
          <a href="https://github.com/rahulr311295" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Breaking Pwn Adventure 3 - Part 2(Speed Hack, SuperJump and Pointers Offline Mode)">
    <meta itemprop="description" content="Creating Speed Hack and Super Jump on Pwn Adventure 3 using Cheat Engine">
    <meta itemprop="datePublished" content="April 15, 2022">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Breaking Pwn Adventure 3 - Part 2(Speed Hack, SuperJump and Pointers Offline Mode)
</h1>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <p class="page__meta">
          
            <i class="fa fa-fw fa-calendar" aria-hidden="true"></i> <time datetime="2022-04-15T00:00:00+05:30">April 15, 2022 </time>&emsp;
          
          
        </p>
        <p>In this part I will be explaining how to increase out player speed and our jump velocity  and finding pointers to these values to be persistant.</p>

<h1 id="speed-hack--super-jump">Speed Hack &amp; Super Jump</h1>
<p>We can start by attaching our game to cheat engine and scaning for the health value of the player.
<img src="/assets/images/pwnadventure/partII/scan1.PNG" alt="" />
We have our health address and now we can  find what instruction writes to this address when we get damaged by an enemy for that we need to right click on the address and select <strong>Find out what writes to this address</strong> or press <strong>F6</strong> a small window will be shown and it will be populated once we start getting damage.
<img src="/assets/images/pwnadventure/partII/writes2.PNG" alt="" />
The instruction excecuted when getting damage is <strong>sub [edi+30],eax</strong> so the address in EDI is the base address of the player and offset 30 is the place where our player’s health is stored. We can now click on that instruction to get more information and grab the address of EDI.
<img src="/assets/images/pwnadventure/partII/healthEDI.PNG" alt="" />
In my case my EDI address is 0x4EC76D78 no we can use this address to view the structure related with the player for that we need to go to the disassembler and click the tools  and select Dissect Data Structure.
<img src="/assets/images/pwnadventure/partII/datastructure.PNG" alt="" />
Normally in games the player or the enemy object’s data such as health,position,names are stored in structures with an offset so each time the tries to access some for example the player’s health all the game needs is the player’s base address and incrementing these offsets will reach the player’s health value.</p>

<blockquote>
  <p>During Dissect Data Structure the base address should be used</p>
</blockquote>

<p>Now we can add our players base address in the box labeled Group 1 and then click on structures and then Define a new structure.
<img src="/assets/images/pwnadventure/partII/datastructure1.PNG" alt="" />
<img src="/assets/images/pwnadventure/partII/datastructure2.PNG" alt="" />
We can verify this by going to offset 30 which contains our player’s health value.Generally variables such as speed are defined in the program as a constant value.
Since this is the player structure the speed value has to be stored somewhere in this sturcture we can find it by moving down the structre and finding whole values such as 100 ,500.450 etc and changing it to a much higher value.</p>

<p><strong>This is not an efficent method as there are chances for our game to crash if we change a wrong structure value.</strong></p>

<p>At offset 190 there is a value of 200 we can add it to our address list and change it to a higher value and try moving in game.</p>
<figure class="video_container">
  <video controls="true" allowfullscreen="true">
    <source src="/assets/images/pwnadventure/partII/speed.mp4" type="video/mp4" />
  </video>
</figure>
<p>As we can see our player’s movement speed increased and we are zooming across the map.</p>

<p>For superjump we use the same method to find the offset where our jump velocity is stored in this game its stored right next to the player’s speed at offset 194 the default value is set to 420.Lets change it to a higher amount and try to jump.
<img src="/assets/images/pwnadventure/partII/jump.PNG" alt="" /></p>
<figure class="video_container">
  <video controls="true" allowfullscreen="true">
    <source src="/assets/images/pwnadventure/partII/jump.mp4" type="video/mp4" />
  </video>
</figure>
<p>Changing it to a higher value has made our player to jump much higher but there is one issue unlike the Gode Mode hack that was made in previous part this is not persistant which means that if we close the game this memory address will become invalid due to <a href="https://www.techtarget.com/searchsecurity/definition/address-space-layout-randomization-ASLR">ASLR</a> thats where pointers come in rescue.</p>

<h1 id="pointers">Pointers</h1>
<p>Due to ASLR when a game restarts the previous addresses that were used will become invalid in order for the game to find the correct address pointers are used some games use single level pointers which means only one offset will be present.
Some games use multilevel pointers where there might be 5 or 6 levels of offsets.
<a href="https://guidedhacking.com/threads/understanding-pointers-how-to-find-pointers.14502/">Guided hacking</a> and <a href="https://www.youtube.com/watch?v=elI6vZR6HGE">LiveOverflow</a> has made an incredible set of videos that tells about pointers and why this is used in development.</p>

<p>We can now start by doing a pointer scan on the player’s speed value by right clicking the value and selecting <strong>pointer scan for this address</strong> and continue which will give out a list of pointers that points to our player speed address normally we can use this method but for this game even though we get pointers that will be invalid when we restart the game since all the logic is tied to the GameLogic.dll file for that we need to find the starting and ending address of the DLL and restrict our pointer scan within that address space for that we can go to the dissassembler and click on view then Memory Regions which will give a list of addresses that the game uses scrolling down we need to find the address where our GameLogic.dll is being loaded to memory.
<img src="/assets/images/pwnadventure/partII/memory.PNG" alt="" />
<img src="/assets/images/pwnadventure/partII/memory1.PNG" alt="" />
We can see that the GameLogic.dll file is loaded at address 67E90000 so we can use this information to restrict our pointer scan.
<img src="/assets/images/pwnadventure/partII/pointer.PNG" alt="" />
<img src="/assets/images/pwnadventure/partII/pointer1.PNG" alt="" />
This will scan for pointers to our player’s speed value within the DLL’s address space.
<img src="/assets/images/pwnadventure/partII/pointer2.PNG" alt="" />
The pointer scan result shows more that 5000 potential pointer paths to verify this we just have to restart the game and attach it to cheat engine.
<img src="/assets/images/pwnadventure/partII/pointer3.PNG" alt="" />
Reattaching the game to cheat engine and checking the pointer scan result we can see that the values are all gone since the previous address is no longer available we can now rescan this pointer map for the value of 200 and see if we have some valid pointers.
<img src="/assets/images/pwnadventure/partII/pointer4.PNG" alt="" />
Since we have restarted the game we need to find the player speed address again and copy the address and use that address to rescan for pointers.
<img src="assets/images/pwnadventure/partII/pointer5.PNG" alt="" />
<img src="assets/images/pwnadventure/partII/pointer6.png" alt="" />
We can see that the result has just shrunk to 14 possible pointers we can add all or a couple to our address list and check if the value gets updated once we restart the game.
<img src="assets/images/pwnadventure/partII/pointer7.png" alt="" />
We know that the player’s speed and jump velocity are apart by just 4 bytes we can add the last offset with 4 to get a pointer path to the jump velocity.</p>

<blockquote>
  <p>The cheat engine cheat table is available in my <a href="https://github.com/rahulr311295/GameTrainers/blob/main/PwnAdventure3/CheatTable/PwnAdventure3.CT">github</a> if anyone wishes to try out.</p>
</blockquote>

        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#cheatengine" class="page__taxonomy-item" rel="tag">cheatengine</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#gamehacking" class="page__taxonomy-item" rel="tag">gamehacking</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#reverse-engineering" class="page__taxonomy-item" rel="tag">reverse-engineering</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#capture-the-flag" class="page__taxonomy-item" rel="tag">capture the flag</a><span class="sep">, </span>
    
      
      
      <a href="/categories/#infosec" class="page__taxonomy-item" rel="tag">infosec</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2022-04-15T00:00:00+05:30">April 15, 2022</time></p>
        
      </footer>

      

      
  <nav class="pagination">
    
      <a href="/Breaking-PWNAdventure3-Part1/" class="pagination--pager" title="Breaking Pwn Adventure 3 - Part 1(God Mode + One Hit Kills Offline Mode)
">Previous</a>
    
    
      <a href="#" class="pagination--pager disabled">Next</a>
    
  </nav>

    </div>

    
  </article>

  
</div>

    </div>

    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 Rahul R</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script data-search-pseudo-elements defer src="https://use.fontawesome.com/releases/v5.7.1/js/all.js" integrity="sha384-eVEQC9zshBn0rFj4+TU78eNA19HMNigMviK/PU/FFjLXqa/GKPgX58rvt5Z8PLs7" crossorigin="anonymous"></script>








  </body>
</html>
