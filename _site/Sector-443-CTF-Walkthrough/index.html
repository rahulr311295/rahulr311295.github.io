<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.15.1 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Sector443 CTF Walkthrough - Rahul R</title>
<meta name="description" content="This is the walkthrough for the challenges that were provided as a part of Sector443’s CTF">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Rahul R">
<meta property="og:title" content="Sector443 CTF Walkthrough">
<meta property="og:url" content="http://localhost:4000/Sector-443-CTF-Walkthrough/">


  <meta property="og:description" content="This is the walkthrough for the challenges that were provided as a part of Sector443’s CTF">



  <meta property="og:image" content="http://localhost:4000/assets/images/sector443/sector443.png">





  <meta property="article:published_time" content="2019-08-12T00:00:00+05:30">





  

  


<link rel="canonical" href="http://localhost:4000/Sector-443-CTF-Walkthrough/">







  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "Rahul R",
      "url": "http://localhost:4000",
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Rahul R Feed">
<link rel="shortcut icon" type="image/png" href="/assets/images/hacker.png"/>
<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6FTHS5L22F"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-6FTHS5L22F');
</script>
<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/masthead.png" alt=""></a>
                
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/" >Home</a>
            </li><li class="masthead__menu-item">
              <a href="/year-archive/" >Posts</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/" >Categories</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/" >Tags</a>
            </li><li class="masthead__menu-item">
              <a href="/about/" >About</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>
    

    <div class="initial-content">
      


  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="http://localhost:4000/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        <li class="current">Sector443 CTF Walkthrough</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="/assets/images/avatar.png" alt="Rahul R" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Rahul R</h3>
    
    
      <p class="author__bio" itemprop="description">
        Pentester, CTF player<br>SOC guy
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">India</span>
        </li>
      

      

      

      

      

      
        <li>
          <a href="https://twitter.com/Rahul_R95" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter
          </a>
        </li>
      

      
        <li>
          <a href="https://www.facebook.com/rahul.raveendran.92351" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-facebook-square" aria-hidden="true"></i> Facebook
          </a>
        </li>
      

      

      
        <li>
          <a href="https://www.linkedin.com/in/rahul-r-3b0433a6" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn
          </a>
        </li>
      

      

      

      

      

      
        <li>
          <a href="https://github.com/rahulr311295" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Sector443 CTF Walkthrough">
    <meta itemprop="description" content="This is the walkthrough for the challenges that were provided as a part of Sector443’s CTF">
    <meta itemprop="datePublished" content="August 12, 2019">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Sector443 CTF Walkthrough
</h1>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <p class="page__meta">
          
            <i class="fa fa-fw fa-calendar" aria-hidden="true"></i> <time datetime="2019-08-12T00:00:00+05:30">August 12, 2019 </time>&emsp;
          
          
        </p>
        <p>This is where it all started I was watching an episode of The Boys when a friend of mine gave me a link to this CTF and asked me to play if I had the time, and I has plenty XD<br />
Most of the challenges where based on reverse engineering binaries.</p>

<p><strong>WEB</strong></p>

<p><img src="/assets/images/sector443/sector443_web.png" alt="" /></p>

<p>The challenge had an HTML file when opened with a browser it gives a prompt to enter a password the end goal is to find the password which is the flag.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;title&gt;</span>Obfuscation JS<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
    <span class="kd">function</span> <span class="nx">dechiffre</span><span class="p">(</span><span class="nx">pass_enc</span><span class="p">){</span>
        <span class="kd">var</span> <span class="nx">pass</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">70,65,85,88,32,80,65,83,83,87,79,82,68,32,72,65,72,65</span><span class="dl">"</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">tab</span>  <span class="o">=</span> <span class="nx">pass_enc</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">'</span><span class="s1">,</span><span class="dl">'</span><span class="p">);</span>
                <span class="kd">var</span> <span class="nx">tab2</span> <span class="o">=</span> <span class="nx">pass</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">'</span><span class="s1">,</span><span class="dl">'</span><span class="p">);</span>
                <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span><span class="nx">j</span><span class="p">,</span><span class="nx">k</span><span class="p">,</span><span class="nx">l</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">m</span><span class="p">,</span><span class="nx">n</span><span class="p">,</span><span class="nx">o</span><span class="p">,</span><span class="nx">p</span> <span class="o">=</span> <span class="dl">""</span><span class="p">;</span>
                <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="nx">j</span> <span class="o">=</span> <span class="nx">tab</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
                <span class="nx">k</span> <span class="o">=</span> <span class="nx">j</span> <span class="o">+</span> <span class="p">(</span><span class="nx">l</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="nx">n</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span>
                <span class="nx">n</span> <span class="o">=</span> <span class="nx">tab2</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
                <span class="k">for</span><span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="p">(</span><span class="nx">o</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="p">(</span><span class="nx">k</span> <span class="o">=</span> <span class="nx">j</span> <span class="o">=</span> <span class="nx">n</span><span class="p">);</span> <span class="nx">i</span><span class="o">++</span> <span class="p">)</span>
                <span class="p">{</span>
                    <span class="nx">o</span> <span class="o">=</span> <span class="nx">tab</span><span class="p">[</span><span class="nx">i</span><span class="o">-</span><span class="nx">l</span><span class="p">];</span>
                    <span class="nx">p</span> <span class="o">+=</span> <span class="nb">String</span><span class="p">.</span><span class="nx">fromCharCode</span><span class="p">((</span><span class="nx">o</span> <span class="o">=</span> <span class="nx">tab2</span><span class="p">[</span><span class="nx">i</span><span class="p">]));</span>
                    <span class="k">if</span><span class="p">(</span><span class="nx">i</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span><span class="k">break</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">for</span><span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="p">(</span><span class="nx">o</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="p">(</span><span class="nx">k</span> <span class="o">=</span> <span class="nx">j</span> <span class="o">=</span> <span class="nx">n</span><span class="p">);</span> <span class="nx">i</span><span class="o">++</span> <span class="p">)</span>
                <span class="p">{</span>
                <span class="nx">o</span> <span class="o">=</span> <span class="nx">tab</span><span class="p">[</span><span class="nx">i</span><span class="o">-</span><span class="nx">l</span><span class="p">];</span> 
                <span class="k">if</span><span class="p">(</span><span class="nx">i</span> <span class="o">&gt;</span> <span class="mi">5</span> <span class="o">&amp;&amp;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="nx">p</span> <span class="o">+=</span> <span class="nb">String</span><span class="p">.</span><span class="nx">fromCharCode</span><span class="p">((</span><span class="nx">o</span> <span class="o">=</span> <span class="nx">tab2</span><span class="p">[</span><span class="nx">i</span><span class="p">]));</span>
                        <span class="p">}</span>
        <span class="nx">p</span> <span class="o">+=</span> <span class="nb">String</span><span class="p">.</span><span class="nx">fromCharCode</span><span class="p">(</span><span class="nx">tab2</span><span class="p">[</span><span class="mi">17</span><span class="p">]);</span>
        <span class="nx">pass</span> <span class="o">=</span> <span class="nx">p</span><span class="p">;</span><span class="k">return</span> <span class="nx">pass</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nb">String</span><span class="p">[</span><span class="dl">"</span><span class="s2">fromCharCode</span><span class="dl">"</span><span class="p">](</span><span class="nx">dechiffre</span><span class="p">(</span><span class="dl">"</span><span class="se">\</span><span class="s2">x31</span><span class="se">\</span><span class="s2">x30</span><span class="se">\</span><span class="s2">x32</span><span class="se">\</span><span class="s2">x2c</span><span class="se">\</span><span class="s2">x31</span><span class="se">\</span><span class="s2">x30</span><span class="se">\</span><span class="s2">x38</span><span class="se">\</span><span class="s2">x2c</span><span class="se">\</span><span class="s2">x39</span><span class="se">\</span><span class="s2">x37</span><span class="se">\</span><span class="s2">x2c</span><span class="se">\</span><span class="s2">x31</span><span class="se">\</span><span class="s2">x30</span><span class="se">\</span><span class="s2">x33</span><span class="se">\</span><span class="s2">x2c</span><span class="se">\</span><span class="s2">x31</span><span class="se">\</span><span class="s2">x32</span><span class="se">\</span><span class="s2">x33</span><span class="se">\</span><span class="s2">x2c</span><span class="se">\</span><span class="s2">x35</span><span class="se">\</span><span class="s2">x35</span><span class="se">\</span><span class="s2">x2c</span><span class="se">\</span><span class="s2">x35</span><span class="se">\</span><span class="s2">x36</span><span class="se">\</span><span class="s2">x2c</span><span class="se">\</span><span class="s2">x35</span><span class="se">\</span><span class="s2">x34</span><span class="se">\</span><span class="s2">x2c</span><span class="se">\</span><span class="s2">x37</span><span class="se">\</span><span class="s2">x39</span><span class="se">\</span><span class="s2">x2c</span><span class="se">\</span><span class="s2">x31</span><span class="se">\</span><span class="s2">x31</span><span class="se">\</span><span class="s2">x35</span><span class="se">\</span><span class="s2">x2c</span><span class="se">\</span><span class="s2">x36</span><span class="se">\</span><span class="s2">x39</span><span class="se">\</span><span class="s2">x2c</span><span class="se">\</span><span class="s2">x31</span><span class="se">\</span><span class="s2">x31</span><span class="se">\</span><span class="s2">x34</span><span class="se">\</span><span class="s2">x2c</span><span class="se">\</span><span class="s2">x31</span><span class="se">\</span><span class="s2">x31</span><span class="se">\</span><span class="s2">x36</span><span class="se">\</span><span class="s2">x2c</span><span class="se">\</span><span class="s2">x31</span><span class="se">\</span><span class="s2">x30</span><span class="se">\</span><span class="s2">x37</span><span class="se">\</span><span class="s2">x2c</span><span class="se">\</span><span class="s2">x34</span><span class="se">\</span><span class="s2">x39</span><span class="se">\</span><span class="s2">x2c</span><span class="se">\</span><span class="s2">x35</span><span class="se">\</span><span class="s2">x30</span><span class="se">\</span><span class="s2">x2c</span><span class="se">\</span><span class="s2">x31</span><span class="se">\</span><span class="s2">x32</span><span class="se">\</span><span class="s2">x35</span><span class="dl">"</span><span class="p">));</span>
    
    <span class="nx">h</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">prompt</span><span class="p">(</span><span class="dl">'</span><span class="s1">Enter password</span><span class="dl">'</span><span class="p">);</span>
    <span class="nx">alert</span><span class="p">(</span> <span class="nx">dechiffre</span><span class="p">(</span><span class="nx">h</span><span class="p">)</span> <span class="p">);</span>
    
<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>

<p>By the looks of it I can see a load of variable declaration and looping by the hex thing looks promising by printing it on console it spits out some char codes.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="se">\</span><span class="s2">x31</span><span class="se">\</span><span class="s2">x30</span><span class="se">\</span><span class="s2">x32</span><span class="se">\</span><span class="s2">x2c</span><span class="se">\</span><span class="s2">x31</span><span class="se">\</span><span class="s2">x30</span><span class="se">\</span><span class="s2">x38</span><span class="se">\</span><span class="s2">x2c</span><span class="se">\</span><span class="s2">x39</span><span class="se">\</span><span class="s2">x37</span><span class="se">\</span><span class="s2">x2c</span><span class="se">\</span><span class="s2">x31</span><span class="se">\</span><span class="s2">x30</span><span class="se">\</span><span class="s2">x33</span><span class="se">\</span><span class="s2">x2c</span><span class="se">\</span><span class="s2">x31</span><span class="se">\</span><span class="s2">x32</span><span class="se">\</span><span class="s2">x33</span><span class="se">\</span><span class="s2">x2c</span><span class="se">\</span><span class="s2">x35</span><span class="se">\</span><span class="s2">x35</span><span class="se">\</span><span class="s2">x2c</span><span class="se">\</span><span class="s2">x35</span><span class="se">\</span><span class="s2">x36</span><span class="se">\</span><span class="s2">x2c</span><span class="se">\</span><span class="s2">x35</span><span class="se">\</span><span class="s2">x34</span><span class="se">\</span><span class="s2">x2c</span><span class="se">\</span><span class="s2">x37</span><span class="se">\</span><span class="s2">x39</span><span class="se">\</span><span class="s2">x2c</span><span class="se">\</span><span class="s2">x31</span><span class="se">\</span><span class="s2">x31</span><span class="se">\</span><span class="s2">x35</span><span class="se">\</span><span class="s2">x2c</span><span class="se">\</span><span class="s2">x36</span><span class="se">\</span><span class="s2">x39</span><span class="se">\</span><span class="s2">x2c</span><span class="se">\</span><span class="s2">x31</span><span class="se">\</span><span class="s2">x31</span><span class="se">\</span><span class="s2">x34</span><span class="se">\</span><span class="s2">x2c</span><span class="se">\</span><span class="s2">x31</span><span class="se">\</span><span class="s2">x31</span><span class="se">\</span><span class="s2">x36</span><span class="se">\</span><span class="s2">x2c</span><span class="se">\</span><span class="s2">x31</span><span class="se">\</span><span class="s2">x30</span><span class="se">\</span><span class="s2">x37</span><span class="se">\</span><span class="s2">x2c</span><span class="se">\</span><span class="s2">x34</span><span class="se">\</span><span class="s2">x39</span><span class="se">\</span><span class="s2">x2c</span><span class="se">\</span><span class="s2">x35</span><span class="se">\</span><span class="s2">x30</span><span class="se">\</span><span class="s2">x2c</span><span class="se">\</span><span class="s2">x31</span><span class="se">\</span><span class="s2">x32</span><span class="se">\</span><span class="s2">x35</span><span class="dl">"</span><span class="p">);</span>
</code></pre></div></div>
<p>Now we have a set of char codes which can then be converted using the String.fromCharCode function which returns the flag.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">print</span><span class="p">(</span><span class="nb">String</span><span class="p">.</span><span class="nx">fromCharCode</span><span class="p">(</span><span class="mi">102</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span><span class="mi">103</span><span class="p">,</span><span class="mi">123</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">56</span><span class="p">,</span><span class="mi">54</span><span class="p">,</span><span class="mi">79</span><span class="p">,</span><span class="mi">115</span><span class="p">,</span><span class="mi">69</span><span class="p">,</span><span class="mi">114</span><span class="p">,</span><span class="mi">116</span><span class="p">,</span><span class="mi">107</span><span class="p">,</span><span class="mi">49</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">125</span><span class="p">));</span>
<span class="c1">//flag{786OsErtk12}</span>
</code></pre></div></div>

<p><strong>STEG</strong></p>

<p><img src="/assets/images/sector443/sector443_steg.png" alt="" /></p>

<p>The challenge gives us a GIF of Captain America flying.</p>

<p><img src="/assets/images/sector443/captain.gif" alt="" /></p>

<p>By running binwalk over it to check for hidden files we can see that there is a RAR file embedded in the GIF.</p>

<p><img src="/assets/images/sector443/binwalk.png" alt="" /></p>

<p>After extracting the RAR file we have another image and a text file.</p>

<p><img src="/assets/images/sector443/know_the_correct_cipher.jpg" alt="" /></p>

<p>Chasing and avenging the hydra’s head Arnim Zola, captain america finally got control over the ship and crashed into the Arctic going into a unconsciousness sleep of “steghide”. Releasing Next: Captain America “wintersoldier”.So we have steghide and wintersoldier which means only one thing.</p>

<p><img src="/assets/images/sector443/steghide.png" alt="" /></p>

<p><strong>Forensics</strong></p>

<p><img src="/assets/images/sector443/sector443_forensic.png" alt="" /></p>

<p>In this challenge we are given a btsnoop log file form which we have to find the unlock sequence and get the value which is the flag, We can view the log file on wireshark.</p>

<p><img src="/assets/images/sector443/wireshark.png" alt="" /></p>

<p>Now we have to find the Unlock Request , As the challenge description says the the unlock request is send through an app so the Source would be a Smart Phone and the destination is the Smart Lock.</p>

<p>By Filtering the source and searching for a Value attribute I was able to figure out the Unlock request.</p>

<p><img src="/assets/images/sector443/wireshark1.png" alt="" /></p>

<p>As the image shows a Send Write Request is generated from a Redmi4 to the Smart Lock with the handle of 0x0003 and as per the challenge description there should be 5 requests by counting them I knew this was it.</p>

<p><strong>OSINT</strong></p>

<p><img src="/assets/images/sector443/sector443_osint.png" alt="" /></p>

<p>In this challenge the goal is to find a person whose name is “Peter Grulich” who likes ponies and we need to find the flag.I started my search in google by entering the following.</p>

<p><img src="/assets/images/sector443/sector443_osint_google.png" alt="" /></p>

<p><img src="/assets/images/sector443/sector443_osint_git.png" alt="" /></p>

<p>The first thing is a GitHub profile by investigating I noticed that the account is created at the time of the CTF and there is only one repository by looking at the commit history there is a peculiar commit.</p>

<p><img src="/assets/images/sector443/sector443_osint_git_comit.png" alt="" /></p>

<p>By checking the Remove secret commit we have a flag.</p>

<p><img src="/assets/images/sector443/sector443_osint_git_flag.png" alt="" /></p>

<p><strong>PWN</strong></p>

<p><img src="/assets/images/sector443/sector443_script_kiddie.png" alt="" /></p>

<p>In this challenge we have to download a VM and import it to virtual box in order to solve the challenge,Before that a Host only connection has to be made in order to access the box (which I didn’t like) ,After importing the machine and staring it we have a static IP address.<br />
By doing an NMAP on the IP address we can see that a port 8080 is open which is running Apache Tomcat.</p>

<p><img src="/assets/images/sector443/sector443_script_kiddie_nmap.png" alt="" /></p>

<p><img src="/assets/images/sector443/sector443_script_kiddie1.png" alt="" /></p>

<p>By checking the manager page we have a login prompt by trying admin:admin we are able to login to the app.</p>

<p><img src="/assets/images/sector443/sector443_script_kiddie2.png" alt="" /></p>

<p><img src="/assets/images/sector443/sector443_script_kiddie3.png" alt="" /></p>

<p>Now we have a shell and the flag.</p>

<p><strong>l33t</strong></p>

<p><img src="/assets/images/sector443/sector443_133t.png" alt="" /></p>

<p>In this challenge we have an encrypted firmware file and our goal is to decrypt it and find the flag and this was the most point heavy challenge and the author says the challenge is for 1337s so I stared my research which ended up nowhere then I had to seek help from the 1337s themselves so I asked <a href="https://twitter.com/liveoverflow">liveoverflow</a> to help me figure this out (hope he is not mad at me as I had to push his limit in patience) with one look he said that the file is XOR encrypted  and asked me to figure out the solution.Lets talk about XOR Encryption </p>

<p>In a XOR encryption we have a plain text and a key if we want to encrypt the plain text we xor each byte of the plain text with the key which results in an encrypted text.</p>

<p><img src="/assets/images/sector443/xor01.png" alt="" /></p>

<p>To decrypt the cipher we need to xor the cipher text again with the key which converts into the plain text.
 <img src="/assets/images/sector443/xor02.png" alt="" /></p>

<p>This is a case of single byte XOR which means that the key is of only one character or one byte but in our case its not a single byte XOR but a multi byte XOR which means our key has multiple characters.</p>

<p>After hours of searching I stumbled upon a <a href="https://stackoverflow.com/questions/1135186/whats-wrong-with-xor-encryption">stackoverflow</a> post which says that when a nullbyte is XORed with a key the result will be the key for example.</p>

<p><img src="/assets/images/sector443/cipher.png" alt="" /></p>

<p>As we can see that 0x41 is the hex value for A and 0x42 is the hex value for B when we XOR 0x41 with 0x42 the output is 0x3 and when we XOR a null byte ie 0x00 with 0x41 we get the output of 0x41 which was the key used now we need to find a pattern of null bytes to get the key for decryption</p>

<p>By looking at the hexdump of the file I noticed an unusual amount of the string toor.</p>

<p><img src="/assets/images/sector443/hexedit.png" alt="" /></p>

<p>As the NULL Bytes in the firmware file gets XORed it spits out the character of the key which was used for encryption.</p>

<p>Now we need to write a script that XORs each byte of the firmware file with each byte of the key.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/python
</span><span class="kn">import</span> <span class="nn">binascii</span>
<span class="n">inputfile</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s">'stage2.bin'</span><span class="p">,</span> <span class="s">'rb'</span><span class="p">)</span>
<span class="n">outputfile</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s">'decode_stage.bin'</span><span class="p">,</span><span class="s">'w+b'</span><span class="p">)</span>
<span class="n">key</span><span class="o">=</span><span class="p">[</span><span class="mh">0x74</span><span class="p">,</span><span class="mh">0x6f</span><span class="p">,</span><span class="mh">0x6f</span><span class="p">,</span><span class="mh">0x72</span><span class="p">]</span>
 <span class="c1"># key = toor
</span><span class="n">counter</span><span class="o">=</span><span class="mi">0</span>
<span class="n">byte</span><span class="o">=</span><span class="n">inputfile</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="k">while</span> <span class="n">byte</span> <span class="o">!=</span><span class="s">""</span><span class="p">:</span>
	<span class="n">byte</span> <span class="o">=</span><span class="nb">ord</span><span class="p">(</span><span class="n">byte</span><span class="p">)</span> 
	<span class="n">byte</span><span class="o">=</span><span class="n">byte</span> <span class="o">^</span> <span class="n">key</span><span class="p">[</span><span class="n">counter</span><span class="p">]</span>
	<span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
	<span class="k">if</span> <span class="n">counter</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
		<span class="n">counter</span><span class="o">=</span><span class="mi">0</span>
	<span class="n">outputfile</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">'%c'</span> <span class="o">%</span> <span class="n">byte</span><span class="p">)</span>
	<span class="n">byte</span><span class="o">=</span> <span class="n">inputfile</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">outputfile</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<p>Now we have a decrypted file all we have to do now is to extract the firmware using binwalk and find the backdoor.</p>

<p><img src="/assets/images/sector443/binwa.png" alt="" /></p>

<p>And here is the flag.</p>

<p><img src="/assets/images/sector443/bin_flag.png" alt="" /></p>


        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#ctf" class="page__taxonomy-item" rel="tag">ctf</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#jeopardy" class="page__taxonomy-item" rel="tag">jeopardy</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#capture-the-flag" class="page__taxonomy-item" rel="tag">capture the flag</a><span class="sep">, </span>
    
      
      
      <a href="/categories/#infosec" class="page__taxonomy-item" rel="tag">infosec</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2019-08-12T00:00:00+05:30">August 12, 2019</time></p>
        
      </footer>

      

      
  <nav class="pagination">
    
      <a href="#" class="pagination--pager disabled">Previous</a>
    
    
      <a href="/C0C0N-XII-CTF-Walkthrough/" class="pagination--pager" title="COCON XII DOME CTF Walkthrough
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
</div>

    </div>

    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 Rahul R</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script data-search-pseudo-elements defer src="https://use.fontawesome.com/releases/v5.7.1/js/all.js" integrity="sha384-eVEQC9zshBn0rFj4+TU78eNA19HMNigMviK/PU/FFjLXqa/GKPgX58rvt5Z8PLs7" crossorigin="anonymous"></script>








  </body>
</html>
