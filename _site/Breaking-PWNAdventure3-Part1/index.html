<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.15.1 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Breaking Pwn Adventure 3 - Part 1(God Mode + One Hit Kills Offline Mode) - Rahul R</title>
<meta name="description" content="Creating God Mode and One Hit Kills on Pwn Adventure 3 using Cheat Engine">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Rahul R">
<meta property="og:title" content="Breaking Pwn Adventure 3 - Part 1(God Mode + One Hit Kills Offline Mode)">
<meta property="og:url" content="http://localhost:4000/Breaking-PWNAdventure3-Part1/">


  <meta property="og:description" content="Creating God Mode and One Hit Kills on Pwn Adventure 3 using Cheat Engine">



  <meta property="og:image" content="http://localhost:4000/assets/images/pwnadventure/logo.png">





  <meta property="article:published_time" content="2022-04-09T00:00:00+05:30">





  

  


<link rel="canonical" href="http://localhost:4000/Breaking-PWNAdventure3-Part1/">







  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "Rahul R",
      "url": "http://localhost:4000",
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Rahul R Feed">
<link rel="shortcut icon" type="image/png" href="/assets/images/hacker.png"/>
<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6FTHS5L22F"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-6FTHS5L22F');
</script>
<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/masthead.png" alt=""></a>
                
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/" >Home</a>
            </li><li class="masthead__menu-item">
              <a href="/year-archive/" >Posts</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/" >Categories</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/" >Tags</a>
            </li><li class="masthead__menu-item">
              <a href="/about/" >About</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>
    

    <div class="initial-content">
      


  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="http://localhost:4000/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        <li class="current">Breaking Pwn Adventure 3 - Part 1(God Mode + One Hit Kills Offline Mode)</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="/assets/images/avatar.png" alt="Rahul R" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Rahul R</h3>
    
    
      <p class="author__bio" itemprop="description">
        Pentester, CTF player<br>SOC guy
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">India</span>
        </li>
      

      

      

      

      

      
        <li>
          <a href="https://twitter.com/Rahul_R95" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter
          </a>
        </li>
      

      
        <li>
          <a href="https://www.facebook.com/rahul.raveendran.92351" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-facebook-square" aria-hidden="true"></i> Facebook
          </a>
        </li>
      

      

      
        <li>
          <a href="https://www.linkedin.com/in/rahul-r-3b0433a6" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn
          </a>
        </li>
      

      

      

      

      

      
        <li>
          <a href="https://github.com/rahulr311295" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Breaking Pwn Adventure 3 - Part 1(God Mode + One Hit Kills Offline Mode)">
    <meta itemprop="description" content="Creating God Mode and One Hit Kills on Pwn Adventure 3 using Cheat Engine">
    <meta itemprop="datePublished" content="April 09, 2022">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Breaking Pwn Adventure 3 - Part 1(God Mode + One Hit Kills Offline Mode)
</h1>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <p class="page__meta">
          
            <i class="fa fa-fw fa-calendar" aria-hidden="true"></i> <time datetime="2022-04-09T00:00:00+05:30">April 09, 2022 </time>&emsp;
          
          
        </p>
        <h1 id="prologue">Prologue</h1>
<p><img src="/assets/images/pwnadventure/logo.png" alt="" /></p>

<blockquote>
  <p>Readers can ignore this if required</p>
</blockquote>

<p>Ever since the awesome <a href="https://twitter.com/LiveOverflow">LiveOverflow</a> released his game hacking <a href="https://www.youtube.com/playlist?list=PLhixgUqwRTjzzBeFSHXrw9DnQtssdAwgG">playlist</a>. I always wanted to try it out myself figuring out how things worked eventhough I have zero skill in reading assembly, reverse engineering or even writing code.</p>

<p>Game Hacking is no easy job it requires time , many hours of trial and error , crashing and I have to admire the efforts put by LiveOverflow in creating his Game Hacking series. I had my fare share of Game Hacking in my teen years which was the first time I used <a href="https://www.cheatengine.org/">Cheat Engine</a> to change the current amount of in game money that I had in GTA Vice City. Iâ€™ve only used it once without knowing the potential that tool had</p>

<p>Since  I consider this as a learning experience I thought of posting my journey here as a journal.</p>

<h1 id="god-mode-and-one-hit-kills">God Mode and One Hit Kills</h1>
<p>To start our hacks we need to attach the game process by opening Cheat Engine and attaching the game.
<img src="/assets/images/pwnadventure/partI/processattach.PNG" alt="" /></p>

<p>Next we need to confirm what value we need to find in this case Im going after the Health Value.For that lets start a scan by setting the Scan Type to <strong>Exact Value</strong> and the Value Type as <strong>4 Bytes</strong> since the Health value is an interger and start a new scan.</p>
<blockquote>
  <p>Note : Some games also use float value type for Health , Ammo etc</p>
</blockquote>

<p><img src="/assets/images/pwnadventure/partI/scan1.PNG" alt="" /></p>

<p>We have around 10K value we can futher refine by getting some damage from the enemies.</p>

<p><img src="/assets/images/pwnadventure/partI/damage1.PNG" alt="" /></p>

<p>Now our health has been reduced to 92 we can use that value to do the next scan.
<img src="/assets/images/pwnadventure/partI/scan1.PNG" alt="" />
We have now 43 potential memory addresses that has our health value all 43 of the address will change we can isolate the correct address by add all 43 of the memory addresses to our address list and freezing a couple of the address and taking damage.
<img src="/assets/images/pwnadventure/partI/freeze.gif" alt="" />
We can see that our health keeps going back to 100 everytime we get damage we can further verify this by changing the value to something high.
<img src="/assets/images/pwnadventure/partI/freeze.PNG" alt="" />
By selecting 3 of the address and changing the value to 1337 the first and the last value changed so one of these address is the address that stores our health.We can  now isolate those 2 memory address and change the value one by one until we find the right address.</p>

<p>To implement God Mode we need to find what instruction writes to this address when we get damaged by an enemy for that we need to right click on the address and select <strong>Find out what writes to this address</strong> or press <strong>F6</strong> a small window will be shown and it will be populated once we start getting damage.</p>

<p><img src="/assets/images/pwnadventure/partI/writestoaddress.PNG" alt="" /></p>

<p>We can now take damage from an enemy and our empty box gets filled with an instruction <strong>sub [edi+30],eax</strong>
<img src="/assets/images/pwnadventure/partI/writestoaddress1.PNG" alt="" />
We can now investigate what are the values stored in the register by clicking on it and looking in the bottom window.
<img src="/assets/images/pwnadventure/partI/writestoaddress2.PNG" alt="" /></p>

<p>So the register EAX containes the value 8 which is the damage done by the Giant Rats on a single hit which is then subtracted from value stored in EDI + 30 where EDI is the base address and 30 is an offset.
Since our goal is to acheive God Mode we could just NOP out this instruction so that when ever we get hit our health wont be subtracted.
We can do that by click the <strong>Show disassembler</strong> button which will show a disassembler similar to OllyDBG or Immunity Debugger.</p>

<p>We can now right click on the sub instruction and click on <strong>Replace with code that does nothing</strong> which will replace the SUB instruction with NOPs.
<img src="/assets/images/pwnadventure/partI/nop.PNG" alt="" /></p>

<p><img src="/assets/images/pwnadventure/partI/nop1.PNG" alt="" /></p>

<p>Now we have nopped the instrustion we can check it by getting some damage from an enemy.
<img src="/assets/images/pwnadventure/partI/nop2.gif" alt="" />
Our health is not changing but there is one issue if we shoot an enemy with our fireball the enemy doesnot take damage as well.
<img src="/assets/images/pwnadventure/partI/nop3.gif" alt="" />
This is due to some thing called <a href="https://guidedhacking.com/threads/cheat-engine-shared-opcode-tutorial-gh203.18815/"><strong>Shared OP Codes</strong></a> which means that the instruction  <strong>sub [edi+30],eax</strong> is shared with our player and enemies so if we change these OP Codes it will reflect on both the player and the enemy, So we need to find a value or an offset that can be used to create a comparison between our player and the enemies.</p>
<blockquote>
  <p>Dont forget to restore the nopped instruction</p>
</blockquote>

<p>Fo that we need to right click on the <strong>sub [edi+30],eax</strong> from what writes to this address box and click on <strong>Find out what addresses this code accesses</strong> which will bing a second window.
<img src="/assets/images/pwnadventure/partI/pVeaccess.PNG" alt="" />
<img src="/assets/images/pwnadventure/partI/pVeaccess1.PNG" alt="" />
Now we need to take a hit from an enemy and give a hit to a couple of the enemies as well.
<img src="/assets/images/pwnadventure/partI/pVeaccess2.gif" alt="" />
We can see that we have some entries when we get hit and give out damage we can select a couple of these values and right click and select <strong>Open disect data with selected addesses</strong>.
<img src="/assets/images/pwnadventure/partI/pVedisect.PNG" alt="" /></p>

<p>Which brings another window with our addresses we need to create a group for our enemies for comparison</p>
<figure class="video_container">
  <video controls="true" allowfullscreen="true">
    <source src="/assets/images/pwnadventure/partI/pVesturct.mp4" type="video/mp4" />
  </video>
</figure>
<p>In this sturcture we can check for a certain value that differs the player from other characters that wont be changed during the entire game the items in orange shows entries that are different in both groups in this case the offset 14 contains the name of the Actor.
<img src="/assets/images/pwnadventure/partI/pVesturct.PNG" alt="" /></p>

<p>We can  use this offset to create a comparrison much like an if statement so that our cheat only affects on the enemieâ€™s health.
Lets begin our cheat development by going back to the disassembler and selecting the SUB instruction and clicking on the Tools menu and then selecting the Auto Assemble option. 
There are multiple ways we can inject custom code to a gameâ€™s process Iâ€™ve used code injection method for creating this cheat.
<img src="/assets/images/pwnadventure/partI/inject.PNG" alt="" />
A new editable window will be displayed where we can select the method of injection from the templates menu.
<img src="/assets/images/pwnadventure/partI/inject1.PNG" alt="" />
All our custom code should be kept inside the newmem section. Now we can start by doing a comparison for our God Mode.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[ENABLE]
//code from here to '[DISABLE]' will be used to enable the cheat
alloc(newmem,2048)
label(returnhere)
label(originalcode)
label(exit)

newmem: //this is allocated memory, you have read,write,execute access

cmp  dword ptr [edi+14],'Player' // Compares if the value in EDI+14 is the string player since EDI is our player's base address.

jne originalcode //if its not player move to original code

sub [edi+30],0 //If offset value is equal to player subtract 0 from health

push [edi+30] 

jmp exit // Above operations done exiting from this execution flow This should be done else our code starts going into original code and sets our health to 0 as well if we get hit from an enemy

originalcode:
mov [edi+30],0 // Move 0 to Total Health (Only affects Enemies)
push [edi+30]

exit:
jmp returnhere

"GameLogic.dll"+20C5:
jmp newmem
nop
returnhere:

 
[DISABLE]
//code from here till the end of the code will be used to disable the cheat
dealloc(newmem)
"GameLogic.dll"+20C5:
sub [edi+30],eax
push [edi+30]
//Alt: db 29 47 30 FF 77 30
</code></pre></div></div>
<p>Lets now assign this cheat to our cheat table by going to File and selecting the assign to cheat table.
<img src="/assets/images/pwnadventure/partI/cheat.PNG" alt="" />
Now we can test our cheat see weather we are taking in damage and killing enemies in one hit.</p>
<figure class="video_container">
  <video controls="true" allowfullscreen="true">
    <source src="/assets/images/pwnadventure/partI/godmode.mp4" type="video/mp4" />
  </video>
</figure>
<p>Lets try it out on a Boss and see if this cheat works or not for that lets go to Magmarok and try killing him in one hit.</p>
<figure class="video_container">
  <video controls="true" allowfullscreen="true">
    <source src="/assets/images/pwnadventure/partI/boss.mp4" type="video/mp4" />
  </video>
</figure>


        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#cheatengine" class="page__taxonomy-item" rel="tag">cheatengine</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#gamehacking" class="page__taxonomy-item" rel="tag">gamehacking</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#reverse-engineering" class="page__taxonomy-item" rel="tag">reverse-engineering</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#capture-the-flag" class="page__taxonomy-item" rel="tag">capture the flag</a><span class="sep">, </span>
    
      
      
      <a href="/categories/#infosec" class="page__taxonomy-item" rel="tag">infosec</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2022-04-09T00:00:00+05:30">April 09, 2022</time></p>
        
      </footer>

      

      
  <nav class="pagination">
    
      <a href="/HackTheBox-GamePWN/" class="pagination--pager" title="Hackthebox GamePWN CubeMadness1
">Previous</a>
    
    
      <a href="/Breaking-PWNAdventure3-Part2/" class="pagination--pager" title="Breaking Pwn Adventure 3 - Part 2(Speed Hack, SuperJump and Pointers Offline Mode)
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
</div>

    </div>

    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 Rahul R</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script data-search-pseudo-elements defer src="https://use.fontawesome.com/releases/v5.7.1/js/all.js" integrity="sha384-eVEQC9zshBn0rFj4+TU78eNA19HMNigMviK/PU/FFjLXqa/GKPgX58rvt5Z8PLs7" crossorigin="anonymous"></script>








  </body>
</html>
